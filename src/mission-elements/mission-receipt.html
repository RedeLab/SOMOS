<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-storage-ref.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<link rel="import" href="../app-elements/app-icons.html">
<link rel="import" href="../app-elements/shared-styles.html">
<link rel="import" href="../mixin-elements/mission-duration-mixin.html">

<dom-module id="mission-receipt">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
      }

      #modal-header h2 { color: var(--accent-color); }

    </style>

    <firebase-storage-ref
      metadata="{{metadata}}"
      storage-uri="{{gsUri}}"
      download-url="{{downloadUrl}}"
      log="true"
      id="storage">
    </firebase-storage-ref>

        <div id="modal-header">
          <h2><span> {{data.userName}} </span></h2>
          <span> Enviou evidências de que concluiu essa missão </span>
        </div>

        <div class="receipts">
            <iron-image id="#receipt-upload" style="width: 100%; height: 200px;" sizing="contain" src="{{downloadUrl}}"></iron-image>

          <div class="receipt-text">
            <span> <a href="{{data.description}}">Comprovante</a></span>
          </div>
        </div>
  </template>
  <script>
    class MissionReceipt extends Polymer.Element {
      static get is() { return 'mission-receipt'; }

      static get properties() {
        return {
          data: {
            type: Object
          },
          downloadUrl: String
        };
      }

      constructor() {
        super();
      }

      setRcptData(data) {
        this.set('data', data);
        this._setFirebasePaths();
      }
      _setFirebasePaths() {
        if(this.data.receiptFileName) {
          this.$.storage.path = `/missions/${this.data.missionId}/${this.data.receiptFileName}`;
        }
      }
    }
customElements.define(MissionReceipt.is, MissionReceipt);
</script>
</dom-module>
